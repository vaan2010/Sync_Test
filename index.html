<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šäººåŒæ­¥è¨˜å¸³ç³»çµ±</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 20px auto; padding: 20px; }
        input, button { padding: 10px; font-size: 1em; margin: 5px 0; }
        ul { list-style-type: none; padding: 0; }
        li { background: #f9f9f9; border-bottom: 1px solid #ddd; padding: 10px; display: flex; justify-content: space-between; }
        .amount { font-weight: bold; color: green; }
    </style>
</head>
<body>

    <h2>ğŸ’° å…±ç”¨è¨˜å¸³æœ¬ (FirebaseåŒæ­¥ç‰ˆ)</h2>
    
    <div>
        <input type="text" id="itemInput" placeholder="é …ç›® (ä¾‹å¦‚: æ™šé¤)">
        <input type="number" id="priceInput" placeholder="é‡‘é¡">
        <button onclick="addData()">æ–°å¢ç´€éŒ„</button>
    </div>

    <ul id="accountingList">
        <li>è®€å–è³‡æ–™ä¸­...</li>
    </ul>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // 2. æŠŠä½ ç”³è«‹çš„é…ç½®è²¼åœ¨é€™è£¡ (ä¸€å®šè¦æ›æˆä½ è‡ªå·±çš„!)
        const firebaseConfig = {
    apiKey: "AIzaSyAyebCTYX0SdZbO_wTKVjMyQXmGsnmSkzs",
    authDomain: "travel-30c43.firebaseapp.com",
    databaseURL: "https://travel-30c43-default-rtdb.firebaseio.com",
    projectId: "travel-30c43",
    storageBucket: "travel-30c43.firebasestorage.app",
    messagingSenderId: "402035619902",
    appId: "1:402035619902:web:f492adf217821c093f396f",
    measurementId: "G-SPF452S4LR"
  };

        // åˆå§‹åŒ– Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const dbRef = ref(db, 'records'); // å»ºç«‹ä¸€å€‹å«åš records çš„è³‡æ–™å¤¾

        // --- åŠŸèƒ½ A: æ–°å¢è³‡æ–™ ---
        window.addData = function() {
            const item = document.getElementById('itemInput').value;
            const price = document.getElementById('priceInput').value;

            if(item && price) {
                // å°‡è³‡æ–™æ¨é€åˆ° Firebase
                push(dbRef, {
                    item: item,
                    price: price,
                    timestamp: Date.now()
                });
                
                // æ¸…ç©ºè¼¸å…¥æ¡†
                document.getElementById('itemInput').value = '';
                document.getElementById('priceInput').value = '';
            } else {
                alert("è«‹è¼¸å…¥é …ç›®å’Œé‡‘é¡");
            }
        }

        // --- åŠŸèƒ½ B: å³æ™‚ç›£è½è³‡æ–™ (åŒæ­¥çš„æ ¸å¿ƒ) ---
        // onValue æœƒåœ¨è³‡æ–™åº«æœ‰ä»»ä½•è®Šå‹•æ™‚ï¼Œè‡ªå‹•è§¸ç™¼
        onValue(dbRef, (snapshot) => {
            const listElement = document.getElementById('accountingList');
            listElement.innerHTML = ""; // å…ˆæ¸…ç©ºæ¸…å–®

            const data = snapshot.val();
            
            if (data) {
                // æŠŠè³‡æ–™åº«å›å‚³çš„ç‰©ä»¶è½‰æˆé™£åˆ—ä¸¦é¡¯ç¤º
                Object.keys(data).forEach(key => {
                    const record = data[key];
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <span>${record.item}</span>
                        <span class="amount">$${record.price}</span>
                        <button onclick="deleteData('${key}')" style="margin-left:10px; color:red; font-size:0.8em;">åˆªé™¤</button>
                    `;
                    listElement.appendChild(li);
                });
            } else {
                listElement.innerHTML = "<li>ç›®å‰æ²’æœ‰ç´€éŒ„</li>";
            }
        });

        // --- åŠŸèƒ½ C: åˆªé™¤è³‡æ–™ ---
        // ç‚ºäº†è®“ window å¯ä»¥å‘¼å«æ¨¡çµ„å…§çš„å‡½æ•¸ï¼Œéœ€æ›è¼‰åˆ° window ä¸Š
        window.deleteData = function(key) {
            if(confirm('ç¢ºå®šè¦åˆªé™¤é€™ç­†è³‡æ–™å—ï¼Ÿ')) {
                const itemRef = ref(db, 'records/' + key);
                remove(itemRef);
            }
        }
    </script>
</body>
</html>